import { Head } from 'mdx-deck'
import { SplitRight, Split } from 'mdx-deck/layouts'
import { Appear } from 'mdx-deck'
import { BgImage, TeX, CaptionFloat, Layout, QRLink } from './src'

export { comic as theme } from 'mdx-deck/themes'

<Head>
  <title>byzantine agreement in algorand</title>
</Head>


# byzantine agreement in Algorand

```
early evening
c/o the better fish orchestra

eve@eatbigger.fish
```

---
export default Layout

# Algorand

```notes
let's talk about: ...
```

---
export default Layout

# my favorite byzantine agreement system
<br/>
‚Ä† to date <br/>
‚Ä†‚Ä† with one major flaw


```notes
the major flaw i'll share at the end
but first...
```

---
export default Layout

Why is it my favorite?

- Most explicit adversarial model
- Very resilient (player replaceability)
- Innovative, intuitive, fast
- Much stronger proofs than most whitepapers

```notes
writing style, theory approach very appealing
```

---
export default Layout

# Byzantine Agreement?

- Players agree on a Leader (byzatinely)
- Leader supplies the block

```notes
it is easy to see how this contrasts with POW
```

---
export default Layout

## Given:
- <TeX formula={'3n+1'} /> players in a gossip commons
- <TeX formula={'{v_0, v_1, ... v_{3n+1}}'}/> secret values in set <TeX formula={'M'}/>
- <TeX formula={'i'}/>th player only knows <TeX formula={'v_i'}/>
- a very powerful malicious agent (the Adversary)

```notes
M is some message space, like a binary string of some length
```

---
export default Layout

## Accomplish this:
- by known time t, each player reach a decision
- <div />each player's decision is in <TeX formula={'M \\cup \\bot '}/>
- no two players disagree on their decision
- <div />if <TeX formula={'v_i = V'}/> for all <TeX formula={'i'}/>, then all have decided on <TeX formula={'V'}/>.

```notes
and here, the V is the leader's "name"
```

---
export default Layout

# How can this be done?

---
export default Layout

## Devise a game:
- all players will play faithfully
- game will consist of rounds
- all players will eventually halt
- all players reach a Decision

---
export default Layout

# This is easy in 1 round:

<div /> Each player <TeX formula={'i'}/> gossips <TeX formula={'v_i'}/>.

<div /> If she ever receives a gossiped message that is not <TeX formula={'v_i'}/>, she decides on <TeX formula={'\\bot'}/>.

<div /> If not, then when round 1 ends, decide on <TeX formula={'v_i'}/>.

---
export default Layout

# That was too easy, wasn't it?

yes.

```notes
don't forget: this must not only be true but Provably so
```

---
export default Layout

## Because of our Adversary:

remember, ze is very powerful!

... how powerful, exactly?

---
export default Layout

## Ze can:

- instantaneously corrupt players by name
- control the actions of corrupted players
- perfectly coordinate all corrupt behavior
- adapt hir corruption choices between rounds
- control the message passing network

```notes
so, in our lighthearted game, ze can trivially force all decisions to be \\bot.
```

---
export default Layout

# ü§Ø

```notes
we should just fall down and die, right?
```

---
export default Layout

## Ze cannot, within one round:
- leverage unbounded compute power
- prevent a true message from propagating
- corrupt more than `n` players (honest majority)

```notes
point out that "round" is kinda like a quantum of time

so, for example, writing down the private keys and using them in a later round still
counts as corrupting that user in a later round

emphasize: this is FAR MORE POWERFUL than the adversarial model in bitcoin, stellar
this is also not a totally precise specification but suffices for this talk

and so we walk it back ...
```

---

<BgImage src={require("file-loader!./assets/Matt_Berninger_at_Way_Out_West_2014.jpg")} >
  <CaptionFloat>
    Kim Metso [<a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>], <a href="https://commons.wikimedia.org/wiki/File:Matt_Berninger_at_Way_Out_West_2014.jpg">from Wikimedia Commons</a>
  </CaptionFloat>
</BgImage>


```notes
words of matt berninger: walk it back

new rule:
```

---
export default Layout

# only require resolutions among consistently honest majority

---
export default Layout

## An honest majority should consistently resolve:
- by known time t, each player reach a decision
- <div />each player's decision is in <TeX formula={'M \\cup \\bot '}/>
- no two players disagree on their decision
- <div />if <TeX formula={'v_i = V'}/> for all <TeX formula={'i'}/>, then all have decided on <TeX formula={'V'}/>.

---

# Rounds should be playable in about 10s?

## I guess let's limit our protocol to 5000 legit messages in a round

```notes
Now, you may have even devised a solution in your head just now.
BUT: in order to be practicable, we will add another constraint
```

---
export default Layout

# How can this be done?

---
export default Layout

## Devise a game:
- corrupt players do whatever adversary want
- game will consist of rounds
- only, say, 5000 players have to participate in each round
- honest players will eventually halt
- <div />honest players reach a Decision in <TeX formula={'M \\cup \\{ \\bot \\}'}/>

---
export default Layout

we can do this with 3 wishes from

## the game genie

---
export default Layout

# 1: a graded consensus protocol

---
export default Layout

## Graded consensus:

All players `i` in an honest majority will halt with a transformation like:

<TeX formula={"v'_i \\rightarrow (v_i, g_i)"}/>

```notes
though, in reality, we generally define Graded Consensus for any proportion of honesty, and only solve it for t >= 3n + 1
```

---
export default Layout

<TeX formula={"v'_i \\rightarrow (v_i, g_i)"}/>

- <div /> all <TeX formula={"v'_i, v_i \\in M, g_i \\in \\{0,1,2\\}"} />
- <div /> <TeX formula={"v'_i"} /> is an initial value known only to <TeX formula={'i'} />
- <div /> all honest with <TeX formula={'g > 0'}/> chose same <TeX formula={'v_i'} />
- <div /> honestly chosen <TeX formula={'g'}/> never include both <TeX formula={'0'}/> and <TeX formula={'2'}/>
- <div /> unanimous honest <TeX formula={"v'_i"}/> imply all <TeX formula={'(v_i, g_i) = (V, 2)'}/>

---

<BgImage src={require("file-loader!./assets/gc.jpg")}/>

---
export default Layout

# 2: a binary byzantine agreement protocol
---
export default Layout

## binary BA:

All players `i` in an honest majority will halt with a transformation like:

<TeX formula={"b'_i \\rightarrow b_i"}/>

---
export default Layout

<TeX formula={"b'_i \\rightarrow b_i"}/>

- <div /> all <TeX formula={"b'_i, b_i \\in \\{0,1\\}"} />
- <TeX formula={"b'_i"}/> is an initial bit known only to i
- all honest `i` decide on same result (agreement)
- <div/>unanimous honest <TeX formula={"b'_i"}/> will not flip their bits (consistency)

---

<BgImage src={require("file-loader!./assets/bba.jpg")}/>

---

<BgImage src={require("file-loader!./assets/compose.jpg")}/>

---
export default Layout

# Choosing the initial `v'` for all honest players

What if a player could reliably prove to everyone that they had won a fair, robust, and random lotto?

---
export default Layout

# 3: a sortition scheme

### for all players `i,p,q` and all rounds `r`:
- <TeX formula={"CONFIRM_p(\\sigma_i(r)) = CONFIRM_q(\\sigma_i(r))"}/>
- <TeX formula={"P\[CONFIRM_p(\\sigma_i(r))\] \\approx 1/n"}/>
- <TeX formula={"t < r \\rightarrow \\forall \\Sigma: P\[CONFIRM_p(\\Sigma_{i}(r))\] \\approx 0"} />

```notes
1: players won't disagree on validity
2: distribution is fair
3: for any function Big-Sigma which can be computed before round r begins
```

---
export default Layout

## Ok, so each round choose `v'` like so:
1. every player computes a lotto ticket ùùà(r)
2. if they believe it wins, propagate it
3. everyone chooses the best ùùà winner as `v'` that round

---

# and you can accomplish both efficiency and player-replaceability.

## just choose a sub-committee of users by sortition as well

---
export default Layout

# What about the bad case

the adversary cannot prevent a true winner from propagating their ticket ... but ze will have a true winning ticket hirself in `n/3n+1` cases and CAN elect to send hir true winning ticket only to subset of players:

---
export default Layout

### This case reduces to honest propagation, because ze still has control over block proposal.

### Consequence:

## The adversary can force 1/3 of blocks to omit transactions, and make agreement take maximum allowed time.

```notes
and they can't even do that secretly
```

---
export default Layout

remember, transactions cannot be forged, so the risk we are confronting is that state changes are prevented..

Probability that a requested transaction can be withheld by the adversary for 1 hour:

<TeX formula={"P \\approx 1/3.5 \\times 10^9"} />

```notes
leader's job is to ensure there's an agreed upon ledger order: everyone already has a decently saturated set of transactions.

1 hour is a standard minimum waiting period for bitcoins to clear.
Here, it is a pessimistic maximum.
```

---
export default Layout

# How does this scale?

[ 500M] players in simulation

[ 4K ] committee members

[ 1 ] leader confirmed & block cleared

```notes
these are tested results
note that Bitcoin only has 300000 active users by some estimates
```

---
export default Layout

# Player Replaceability

This is a novel property.

---
export default Layout

The adversary is mobile. Once the protocol begins, why doesn't ze just corrupt all the committee members?

---
export default Layout

The committee is re-randomized in every step, and each step consists of only 1 message being sent by each member, revealing decision and identity simultaneously.

Once that message is propagated, ze cannot stop it, and ze gains no benefit from maintaining corruption of that user, whose job is done.

---
export default Layout

Thus, in a player-replaceable byzantine agreement, even a mobile adversary who must corrupt players by name cannot capture a committee resolution in any step except with negligible probability.

---
export default Layout

That's all really hard to summarize...

```notes
in fact, i think it's in the nature of cryptosystems that it's hard to summarize
but let's give it a shot
```

---
export default Layout

But let's try!

- transactions clear fast
- it is player replaceable
- scales credibly to global usage
- resists Sybil attacks*
- but still works in unpermissioned environments**
- the earth may yet survive

```notes
so you can have Mars, mr musk
but i promised you a Big Flaw
so i've made this reproduction of the first page of the paper:
```

---

# ALGORAND*

Jing Chen ‚Ä¢ Silvio Micali

```
* Algorand‚Äôs technologies are the object of the following patent applications: US62/117,138 US62/120,916 US62/142,318 US62/218,817 US62/314,601 PCT/US2016/018300 US62/326,865 62/331,654 US62/333,340 US62/343,369 US62/344,667 US62/346,775 US62/351,011 US62/653,482 US62/352,195 US62/363,970 US62/369,447 US62/378,753 US62/383,299 US62/394,091 US62/400,361 US62/403,403 US62/410,721 US62/416,959 US62/422,883 US62/455,444 US62/458,746 US62/459,652 US62/460,928 US62/465,931
```

```notes
```

---
export default Layout

current focus of study:

- applicability to underbanked communities
- BLS signatures, related ID-based signatures
- solutions for partial or infrequent connectivity

```notes
brief remarks about why these are interesting
```

---
export default Layout

wrap survey and talk requests:

<QRLink href='https://goo.gl/forms/7cqtyxjKvG3LzPiC3' size={512} bgColor='#FFFFFF00'/>

